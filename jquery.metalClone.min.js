!function(e){e.fn.metalClone=function(t,n){function a(t,n,a,r){var s=n;if(t=0==t?1:t,"after"===r){if(-1!==e.inArray(p,A)&&-1!==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();f.insertAfter(a.find("tr").last()),f.find("td").last().append('<div class="operations"><img src="images/delete.png" class="metalBtnRemove operationsImg"/> '+m+"</div>"),c||i(f)}else if(-1!==e.inArray(p,A)&&-1==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();a.append(f.append('<input type="button" value="'+m+'" class="metalBtnRemove">')),c||i(f)}else if(-1==e.inArray(p,A)&&-1==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();a.append(f.append('<input type="button" value="'+m+'" class="metalBtnRemove">')),c||i(f)}else if(-1==e.inArray(p,A)&&-1!==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();a.append(f.append('<input type="button" value="'+m+'" class="metalBtnRemove">')),c||i(f)}}else if("before"===r)if(-1!==e.inArray(p,A)&&-1!==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();f.insertAfter(a.find("tr").first()),f.find("td").last().append('<div class="operations"><img src="images/delete.png" class="metalBtnRemove operationsImg"/> '+m+"</div>"),c||i(f)}else if(-1!==e.inArray(p,A)&&-1==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();a.prepend(f.append('<input type="button" value="'+m+'" class="metalBtnRemove">')),c||i(f)}else if(-1==e.inArray(p,A)&&-1==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();a.prepend(f.append('<input type="button" value="'+m+'" class="metalBtnRemove">')),c||i(f)}else if(-1==e.inArray(p,A)&&-1!==e.inArray(y,A))for(var l=0;t>l;l++){var f=s.clone();a.prepend(f.append('<input type="button" value="'+m+'" class="metalBtnRemove">')),c||i(f)}e.isArray(d)&&e.isEmptyObject(d)||e.isArray(d)&&!e.isEmptyObject(d)&&o(d)}function r(t,n,a,r){var s=n;if(t=0==t?1:t,"after"===r){if(-1!==e.inArray(p,A))for(var l=0;t>l;l++){var f=s.clone();f.insertAfter(a),f.find("td").last().append('<div class="operations"><img src="images/delete.png" class="metalBtnRemove operationsImg"/> '+m+"</div>"),c||i(f)}if(-1==e.inArray(p,A))for(var l=0;t>l;l++){var f=s.clone();f.insertAfter(a).append('<input type="button" value="'+m+'" class="metalBtnRemove">'),c||i(f)}}else if("before"===r)if(-1!==e.inArray(p,A))for(var l=0;t>l;l++){var f=s.clone();f.insertBefore(a),f.find("td").last().append('<div class="operations"><img src="images/delete.png" class="metalBtnRemove operationsImg"/> '+m+"</div>"),c||i(f)}else for(var l=0;t>l;l++){var f=s.clone();f.insertBefore(a).append('<input type="button" value="'+m+'" class="metalBtnRemove">'),c||i(f)}e.isArray(d)&&e.isEmptyObject(d)||e.isArray(d)&&!e.isEmptyObject(d)&&o(d)}function i(t){t.find('input:not("input[type=button], input[type=submit]"), textarea, select').each(function(){e(this).val("")})}function o(t){var n;n=e.inArray("*",t)?"*":t.join(","),e(l).each(function(t,a){e(this).find(n).each(function(n,a){if(e(this).attr("id")){var r=e(this).attr("id"),i=r.replace(/\d+/g,"");e(this).attr("id",i+parseInt(t))}})})}opt=e.extend({},e.fn.metalClone.defaults,t);var s,l=this.selector,p=this[0].nodeName,c=opt.copyValue,f=opt.position,v=opt.numberToClone,u=opt.destination,d=opt.ids,m=opt.btnRemoveText,y=u?e(u)[0].nodeName:"none",A=["TABLE","TR","TD","TBODY","TFOOT","THEAD","TH"];s=l.match(/[.]/)?e(this).first():e(this);var b,g;-1!==e.inArray(p,A)&&(b=s.closest("table"),g=b.find("tr").first());var T;return null===opt.btnClone?(T="metalBtnClone"+Math.floor(9*Math.random()+1),-1!==e.inArray(p,A)&&-1==e.inArray(y,A)?e("<input/>",{type:"button",value:opt.btnCloneText,"class":T,css:{marginTop:"10px"}}).insertAfter(b):-1!==e.inArray(p,A)&&-1!==e.inArray(y,A)?e("<input/>",{type:"button",value:opt.btnCloneText,"class":T,css:{marginTop:"10px"}}).insertAfter(b):-1==e.inArray(p,A)&&-1==e.inArray(y,A)?e("<input/>",{type:"button",value:opt.btnCloneText,"class":T,css:{marginTop:"10px"}}).insertAfter(l):-1==e.inArray(p,A)&&-1!==e.inArray(y,A)&&e("<input/>",{type:"button",value:opt.btnCloneText,"class":T,css:{marginTop:"10px"}}).insertAfter(l),T="."+T):T=opt.btnClone,e(document).on({mouseenter:function(){e(this).find(".operations").css({display:"block"})},mouseleave:function(){e(this).find(".operations").css({display:"none"})}},l),e(document).on("click",T,function(){var t;return u!==!1?(t=e(u),"after"===f?void a(v,s,t,f):void a(v,s,t,f)):(t=e(l),"after"===f?void r(v,s,t.last(),f):void r(v,s,t.first(),f))}),e(document).on("click",".metalBtnRemove",function(){e(this).closest(l).remove()}),s.each(function(t,n){e(this)})},e.fn.metalClone.defaults={destination:!1,position:"after",numberToClone:1,ids:[],btnClone:null,copyValue:!1,btnRemoveText:"Remove me",btnCloneText:"Create New Element"}}(jQuery);